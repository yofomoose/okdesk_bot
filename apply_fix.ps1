# –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –±—ã—Å—Ç—Ä–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –±–æ—Ç–∞ –≤ Windows PowerShell

Write-Host "üîß –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –¥–ª—è Okdesk Bot" -ForegroundColor Cyan
Write-Host "========================================" -ForegroundColor Cyan

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
if (Test-Path "services\okdesk_api_fixed.py") {
    Write-Host "‚úÖ –ù–∞–π–¥–µ–Ω —Ñ–∞–π–ª –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è" -ForegroundColor Green
} else {
    Write-Host "‚ùå –§–∞–π–ª –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω" -ForegroundColor Red
    exit 1
}

# –°–æ–∑–¥–∞–µ–º —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é —Ç–µ–∫—É—â–µ–≥–æ —Ñ–∞–π–ª–∞
Write-Host "üì¶ –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏..." -ForegroundColor Yellow
Copy-Item "services\okdesk_api.py" -Destination "services\okdesk_api.py.bak"
Write-Host "‚úÖ –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —Å–æ–∑–¥–∞–Ω–∞: services\okdesk_api.py.bak" -ForegroundColor Green

# –ü—Ä–∏–º–µ–Ω—è–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
Write-Host "üîÑ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è..." -ForegroundColor Yellow
Copy-Item "services\okdesk_api_fixed.py" -Destination "services\okdesk_api.py"
Write-Host "‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ" -ForegroundColor Green

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
Write-Host "üöÄ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤..." -ForegroundColor Yellow
docker-compose down
docker-compose up -d --build

# –û–∂–∏–¥–∞–µ–º –∑–∞–ø—É—Å–∫–∞
Write-Host "‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤..." -ForegroundColor Yellow
Start-Sleep -Seconds 10

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏
Write-Host "üìã –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ª–æ–≥–∏ –±–æ—Ç–∞:" -ForegroundColor Cyan
docker-compose logs --tail=20 bot

Write-Host ""
Write-Host "‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ –∏ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ!" -ForegroundColor Green
Write-Host ""
Write-Host "üìù –î–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ª–æ–≥–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:" -ForegroundColor Cyan
Write-Host "   docker-compose logs -f" -ForegroundColor White
