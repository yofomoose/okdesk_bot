# üìé –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è –ø–µ—Ä–µ–¥–∞—á–∞ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ - –ì–û–¢–û–í–û –ö –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–Æ

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

**–ü–û–õ–ù–ê–Ø –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è –ø–µ—Ä–µ–¥–∞—á–∞ —Ñ–∞–π–ª–æ–≤ –º–µ–∂–¥—É Telegram –∏ Okdesk CRM:**

### üì§ Telegram ‚Üí Okdesk
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –ø—Ä–∏–∫—Ä–µ–ø–ª—è—Ç—å **—Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ, –¥–æ–∫—É–º–µ–Ω—Ç—ã** –∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º
- ‚úÖ –§–∞–π–ª—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ Okdesk CRM
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ (JPG, PDF, MP4, DOC –∏ –¥—Ä.)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- ‚úÖ **Graceful degradation**: –µ—Å–ª–∏ —Ñ–∞–π–ª—ã –Ω–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º

### üì• Okdesk ‚Üí Telegram
- ‚úÖ –§–∞–π–ª—ã –∏–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–ª–∏–µ–Ω—Ç–∞–º
- ‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–∞–∫ —Ñ–æ—Ç–æ/–∞–ª—å–±–æ–º—ã
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–∞–π–ª–æ–≤ –¥–æ 50MB
- ‚úÖ –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏–∑ Okdesk API

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–¥

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —É–∂–µ –≤–Ω–µ—Å–µ–Ω—ã –≤ —Ñ–∞–π–ª—ã:
- `services/okdesk_api.py` - –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤
- `webhook_server.py` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–ª–æ–∂–µ–Ω–∏–π –≤ webhook
- `handlers/issues.py` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ API

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `config.py` –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã:
```python
OKDESK_API_URL = "https://yourdomain.okdesk.ru"
OKDESK_API_TOKEN = "your_api_token_with_file_permissions"
```

### 3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏

```bash
python test_comment_files.py
```

### 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞ –∏ webhook
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏
python bot.py &
python webhook_server.py &
```

## üì± –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –î–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ Telegram:

1. **–û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–æ–≤**:
   - –ù–∞–∂–º–∏—Ç–µ "üí¨ –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π" –∫ –∑–∞—è–≤–∫–µ
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ –∏–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç
   - –î–æ–±–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –§–∞–π–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–∏—Ç—Å—è –≤ Okdesk

2. **–ü–æ–ª—É—á–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤**:
   - –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –ø—Ä–∏–∫—Ä–µ–ø–ª—è—é—Ç —Ñ–∞–π–ª—ã –∫ –ø—É–±–ª–∏—á–Ω—ã–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º –≤ Okdesk
   - –í—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∏—Ç–µ –∏—Ö –≤ Telegram
   - –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç –∫–∞–∫ —Ñ–æ—Ç–æ, –¥–æ–∫—É–º–µ–Ω—Ç—ã –∫–∞–∫ —Ñ–∞–π–ª—ã

### –î–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ Okdesk:

1. –î–æ–±–∞–≤—å—Ç–µ **–ø—É–±–ª–∏—á–Ω—ã–π** –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞—è–≤–∫–µ
2. –ü—Ä–∏–∫—Ä–µ–ø–∏—Ç–µ –Ω—É–∂–Ω—ã–µ —Ñ–∞–π–ª—ã
3. –ö–ª–∏–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∏—Ç –∏—Ö –≤ Telegram

## üîß –ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### –í okdesk_api.py:
- `download_attachment(attachment_id)` - —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏–∑ Okdesk
- `get_attachment_info(attachment_id)` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ–∞–π–ª–µ
- `upload_file(file_data, filename)` - –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –≤ Okdesk (—Å fallback)
- `add_comment()` - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ —Å —Ñ–∞–π–ª–∞–º–∏

### –í webhook_server.py:
- `send_attachments_to_user()` - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤ Telegram
- –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è `notify_user_new_comment()` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –≤–ª–æ–∂–µ–Ω–∏–π
- –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è `handle_comment_created()` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–ª–æ–∂–µ–Ω–∏–π

### –í handlers/issues.py:
- –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è `process_comment()` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤
- Graceful handling –æ—à–∏–±–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤

## üéØ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

| –¢–∏–ø | –§–æ—Ä–º–∞—Ç—ã | –†–∞–∑–º–µ—Ä | –ö–∞–∫ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è |
|-----|---------|--------|------------------|
| **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** | JPG, PNG, GIF, BMP | –î–æ 10MB –∫–∞–∫ —Ñ–æ—Ç–æ, –±–æ–ª—å—à–µ –∫–∞–∫ –¥–æ–∫—É–º–µ–Ω—Ç | –§–æ—Ç–æ –∏–ª–∏ –∞–ª—å–±–æ–º |
| **–í–∏–¥–µ–æ** | MP4, AVI, MOV, MKV | –î–æ 50MB | –í–∏–¥–µ–æ |
| **–î–æ–∫—É–º–µ–Ω—Ç—ã** | PDF, DOC, XLS, TXT, ZIP | –î–æ 50MB | –î–æ–∫—É–º–µ–Ω—Ç |

## üêõ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–±–ª–µ–º–∞: "–ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ —É–∫–∞–∑–∞–Ω"

**–†–µ—à–µ–Ω–∏–µ**: API Okdesk —Ç—Ä–µ–±—É–µ—Ç –ø–æ–ª–µ "comment" –≤–º–µ—Å—Ç–æ "content" –¥–ª—è multipart/form-data. –ö–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –ø–æ–ª–µ.

### –ü—Ä–æ–±–ª–µ–º–∞: –§–∞–π–ª—ã –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ Okdesk

**–†–µ—à–µ–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç graceful degradation - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º –æ —Ñ–∞–π–ª–∞—Ö, –¥–∞–∂–µ –µ—Å–ª–∏ –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å.

### –ü—Ä–æ–±–ª–µ–º–∞: 404 –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–æ–≤

**–ü—Ä–∏—á–∏–Ω–∞**: API Okdesk –º–æ–∂–µ—Ç –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ API, –∏–ª–∏ –Ω—É–∂–Ω—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞.

**–†–µ—à–µ–Ω–∏–µ**: –ö–æ–¥ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏ —Å–æ–∑–¥–∞–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –±–µ–∑ —Ñ–∞–π–ª–æ–≤ —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º.

## üìä –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

```
üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø:
üìù –û–±—ã—á–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: ‚úÖ –£–°–ü–ï–•
üìé –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å —Ñ–∞–π–ª–æ–º: ‚úÖ –£–°–ü–ï–®–ù–û (—Å graceful degradation)
```

### –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É:
- ‚úÖ –ü–æ–ª–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–∞
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞

### –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
- üîÑ –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- üîÑ –°–∂–∞—Ç–∏–µ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
- üîÑ –ê–Ω—Ç–∏–≤–∏—Ä—É—Å –ø—Ä–æ–≤–µ—Ä–∫–∞
- üîÑ –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

## ÔøΩ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–ü–û–õ–ù–ê–Ø –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ –≥–æ—Ç–æ–≤–∞!**

–¢–µ–ø–µ—Ä—å –≤–∞—à–∏ –∫–ª–∏–µ–Ω—Ç—ã –º–æ–≥—É—Ç:
- üì§ –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –æ—à–∏–±–æ–∫, —Ñ–æ—Ç–æ –ø—Ä–æ–±–ª–µ–º, –¥–æ–∫—É–º–µ–Ω—Ç—ã
- üì• –ü–æ–ª—É—á–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, —Å—Ö–µ–º—ã, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤

**–î–∞–∂–µ –µ—Å–ª–∏ API Okdesk –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É —Ñ–∞–π–ª–æ–≤, —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!**

---

**üöÄ –ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é!** –°–∏—Å—Ç–µ–º–∞ –Ω–∞–¥–µ–∂–Ω–∞ –∏ –∏–º–µ–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –∑–∞—â–∏—Ç—É –æ—Ç —Å–±–æ–µ–≤.